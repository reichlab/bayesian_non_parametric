

#' Compute a data frame with offset (lag and/or lead) observation vectors
#'
#' @param data a data frame
#' @param vars_and_offsets a named list: The component name matches the name of
#'     one of the variables in data, and the component value is an integer
#'     vector of lags to include for that variable
#' @param id_var_names an optional character vector of column names that
#'     identify times relative to which lags and leads are calculated.  These
#'     columns will be preserved in the result.
#' @param leading_rows_to_drop an integer specifying the number of leading rows
#'     to drop.  This will typically be the largest lag used, but could be larger
#'     for example if we are in the process of searching lags to determine
#'     which ones to include.  Then for example if our search is for lags up to
#'     52, we would want to set leading_rows_to_drop = 52.
#' @param trailing_rows_to_drop an integer specifying the number of trailing rows
#'     to drop.  This will typically be the largest prediction horizon used.
#' @param additional_rows_to_drop an integer vector specifying indices of
#'     additional rows to drop.  For example, if we are performing
#'     cross-validation, we might want to drop all rows within +/- 52 indices of
#'     the current prediction target.
#' @param rows_to_drop an integer vector specifying rows to drop after computing
#'     lagged observation vectors.
compute_offset_obs_vecs <- function(
	data,
	vars_and_offsets,
	id_var_names,
	leading_rows_to_drop = 0,
	trailing_rows_to_drop = 0,
	additional_rows_to_drop = NULL,
	na.action = "na.omit") {
	## validate leading_rows_to_drop, trailing_rows_to_drop, additional_rows_to_drop
	if(any(c(leading_rows_to_drop, trailing_rows_to_drop, additional_rows_to_drop) < 0 |
	c(leading_rows_to_drop, trailing_rows_to_drop, additional_rows_to_drop) > nrow(data))) {
		stop("leading_rows_to_drop, trailing_rows_to_drop, and additional_rows_to_drop must be integers between 0 and nrow(data)")
	}

	## rows to drop -- which rows should not be used as regression/density estimation examples
	## either because the corresponding regression example cannot be formed
	## or because we are performing cross-validation and don't want to use
	## times adjacent to the prediction target
	if(is.logical(additional_rows_to_drop)) {
		additional_rows_to_drop <- which(additional_rows_to_drop)
	}
	rows_to_drop <- c(seq_len(leading_rows_to_drop), # leading -- too early for all lags to be available
		seq_len(trailing_rows_to_drop) + nrow(data) - trailing_rows_to_drop, # trailing -- too late for all prediction horizons to be available
		additional_rows_to_drop # additional (e.g., near prediction target)
	)

	## create a data frame with one column for each entry in the vars_and_offsets argument
	if(missing(id_var_names)) {
		id_var_names <- NULL
	}
	result <- as.data.frame(matrix(NA,
		nrow=nrow(data),
		ncol=nrow(vars_and_offsets) +
			!(is.null(id_var_names))))
	if(is.null(id_var_names)) {
		colnames(result) <- vars_and_offsets$combined_name
	} else {
		colnames(result) <- c(vars_and_offsets$combined_name, id_var_names)
	}

	## set column values in result
	for(new_var_ind in seq_len(nrow(vars_and_offsets))) {
		offset_val <- vars_and_offsets[new_var_ind, "offset_value"]
		offset_type <- as.character(vars_and_offsets[new_var_ind, "offset_type"])
		var_name <- vars_and_offsets[new_var_ind, "var_name"]
		combined_name <- as.character(vars_and_offsets[new_var_ind, "combined_name"])

		if(identical(offset_type, "lag")) {
			if(offset_val < nrow(result)) {
				result_inds <- seq(from = 1 + offset_val, to = nrow(result))
				data_inds <- seq(from = 1, to = nrow(result) - offset_val)
			} else {
				result_inds <- c()
				data_inds <- c()
			}
		} else if(identical(offset_type, "horizon")) {
			if(offset_val < nrow(result)) {
				result_inds <- seq(from = 1, to = nrow(result) - offset_val)
				data_inds <- seq(from = 1 + offset_val, to = nrow(result))
			} else {
				result_inds <- c()
				data_inds <- c()
			}
		} else {
			stop("Invalid offset_type: must be one of \"lag\" or \"horizon\"")
		}

		result[result_inds, combined_name] <- data[data_inds, var_name]
	}

	if(!(is.null(id_var_names))) {
		result[, id_var_names] <- data[, id_var_names]
	}

	## drop specified rows
	if(length(rows_to_drop) > 0) {
		result <- result[-rows_to_drop, , drop=FALSE]
	}

	## Check NAs
	if(identical(na.action, "na.omit")) {
		message("dropping all rows with NAs")
		na_rows <- which(apply(result, 1, anyNA))
		if(length(na_rows) > 0) {
			result <- result[-na_rows, , drop = FALSE]
			if(nrow(result) == 0) {
				stop("0 rows in cross validation data after filtering, computing offsets and dropping NA rows")
			}
		}
	} else if(!identical(na.action, "na.pass")) {
		stop("Unsupported na.action")
	}

	return(result)
}


#' Simplified interface to compute_offset_obs_vecs suitable for getting
#' a matrix of lagged values and a matrix of leading values
#'
#' @param data data frame with data at consecutive times
#' @param var_name character specifying name of the variable we want to lag/lead
#' @param max_lag maximum lag value.  Will return a matrix with a column for
#'   each lag from 0 up to max_lag
#' @param prediction_horizon optional vector of prediction horizons
get_single_ts_train_test <- function(
  data,
  var_name,
  max_lag = 1,
  prediction_horizons = NULL) {

  vars_and_offsets <-
    data.frame(
      var_name =
        rep(var_name, max_lag + 1 + length(prediction_horizons)),
      offset_type =
        c(rep("lag", max_lag + 1), rep("horizon", length(prediction_horizons))),
      offset_value =
        c(rev(seq(from = 0, to = max_lag)), prediction_horizons),
      stringsAsFactors = FALSE) %>%
    mutate(
      combined_name = paste(var_name, offset_type, offset_value, sep = "_")
    )

  all_lag_lead_obs <- compute_offset_obs_vecs(
  	data = data,
  	vars_and_offsets = vars_and_offsets,
  	na.action = "na.omit")

  X <- as.matrix(all_lag_lead_obs[, grepl("lag", names(all_lag_lead_obs))])
  Y <- as.matrix(all_lag_lead_obs[, grepl("horizon", names(all_lag_lead_obs))])

  return(list(X = X, Y = Y))
}

get_X_train_y_train <- function(max_lag, prediction_horizon) {
	data <- get_dengue_data()
	train_seasons <- paste0(1990:2004, "/", 1991:2005)
	data <- filter(data, season %in% train_seasons)

	temp <- get_single_ts_train_test(
	  data = data,
	  var_name = "total_cases",
	  max_lag = max_lag,
	  prediction_horizons = prediction_horizon)
  names(temp) <- c("X_train", "Y_train")

	return(temp)
}

get_X_eval <- function(max_lag, prediction_horizon) {
	data <- get_dengue_data()
	eval_seasons <- paste0(2005:2008, "/", 2006:2009)
	eval_inds <- which(data$season %in% eval_seasons)
	eval_inds <- c(
	  eval_inds[1] - rev(seq_len(max_lag + prediction_horizon)),
	  eval_inds
	)
	data <- data[eval_inds, , drop = FALSE]

	temp <- get_single_ts_train_test(
	  data = data,
	  var_name = "total_cases",
	  max_lag = max_lag)
	names(temp) <- c("X_eval")
  
	return(temp)
}

get_dengue_data <- function() {
	# when we make an R package, replace all calls to this function with references to a data object.
	return(
		structure(list(season = c("1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1990/1991",
			"1990/1991", "1990/1991", "1990/1991", "1990/1991", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1991/1992", "1991/1992", "1991/1992", "1991/1992",
			"1991/1992", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1992/1993", "1992/1993",
			"1992/1993", "1992/1993", "1992/1993", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1993/1994", "1993/1994", "1993/1994", "1993/1994", "1993/1994",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1994/1995", "1994/1995", "1994/1995",
			"1994/1995", "1994/1995", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1995/1996",
			"1995/1996", "1995/1996", "1995/1996", "1995/1996", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1996/1997", "1996/1997", "1996/1997", "1996/1997",
			"1996/1997", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1997/1998", "1997/1998",
			"1997/1998", "1997/1998", "1997/1998", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1998/1999", "1998/1999", "1998/1999", "1998/1999", "1998/1999",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "1999/2000", "1999/2000", "1999/2000",
			"1999/2000", "1999/2000", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2000/2001",
			"2000/2001", "2000/2001", "2000/2001", "2000/2001", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2001/2002", "2001/2002", "2001/2002", "2001/2002",
			"2001/2002", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2002/2003", "2002/2003",
			"2002/2003", "2002/2003", "2002/2003", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2003/2004", "2003/2004", "2003/2004", "2003/2004", "2003/2004",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2004/2005", "2004/2005", "2004/2005",
			"2004/2005", "2004/2005", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2005/2006",
			"2005/2006", "2005/2006", "2005/2006", "2005/2006", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2006/2007", "2006/2007", "2006/2007", "2006/2007",
			"2006/2007", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2007/2008", "2007/2008",
			"2007/2008", "2007/2008", "2007/2008", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009",
			"2008/2009", "2008/2009", "2008/2009", "2008/2009", "2008/2009"
			), total_cases = c(4L, 5L, 4L, 3L, 6L, 2L, 4L, 5L, 10L, 6L, 8L,
			2L, 6L, 17L, 23L, 13L, 21L, 28L, 24L, 20L, 40L, 27L, 42L, 33L,
			43L, 37L, 57L, 71L, 44L, 56L, 53L, 52L, 47L, 26L, 27L, 21L, 21L,
			26L, 34L, 37L, 17L, 19L, 25L, 18L, 21L, 17L, 17L, 16L, 16L, 15L,
			23L, 16L, 17L, 12L, 17L, 10L, 15L, 19L, 21L, 14L, 18L, 13L, 14L,
			18L, 23L, 25L, 62L, 60L, 76L, 66L, 64L, 68L, 89L, 92L, 140L,
			116L, 142L, 129L, 140L, 140L, 127L, 129L, 169L, 141L, 108L, 78L,
			70L, 81L, 104L, 90L, 85L, 55L, 53L, 65L, 33L, 38L, 59L, 40L,
			37L, 29L, 30L, 30L, 28L, 23L, 24L, 29L, 26L, 23L, 20L, 19L, 20L,
			26L, 29L, 31L, 28L, 26L, 32L, 35L, 33L, 30L, 52L, 59L, 67L, 65L,
			74L, 70L, 61L, 53L, 76L, 61L, 57L, 44L, 34L, 47L, 60L, 60L, 53L,
			36L, 31L, 30L, 32L, 28L, 33L, 33L, 35L, 22L, 13L, 13L, 21L, 17L,
			11L, 8L, 8L, 6L, 6L, 7L, 12L, 17L, 10L, 10L, 18L, 19L, 12L, 22L,
			12L, 21L, 18L, 16L, 16L, 22L, 17L, 25L, 23L, 12L, 25L, 28L, 27L,
			18L, 23L, 23L, 29L, 38L, 36L, 43L, 46L, 31L, 25L, 40L, 31L, 38L,
			30L, 22L, 31L, 26L, 35L, 36L, 39L, 25L, 31L, 37L, 33L, 25L, 24L,
			18L, 23L, 13L, 18L, 14L, 17L, 22L, 13L, 24L, 31L, 34L, 31L, 31L,
			38L, 49L, 42L, 49L, 55L, 80L, 84L, 72L, 89L, 115L, 179L, 202L,
			272L, 302L, 395L, 426L, 461L, 381L, 333L, 353L, 410L, 364L, 359L,
			288L, 221L, 149L, 112L, 154L, 91L, 72L, 56L, 46L, 37L, 26L, 17L,
			17L, 20L, 11L, 7L, 16L, 14L, 16L, 5L, 2L, 6L, 5L, 4L, 3L, 4L,
			16L, 8L, 7L, 10L, 14L, 7L, 9L, 11L, 23L, 17L, 19L, 24L, 17L,
			28L, 40L, 33L, 31L, 33L, 29L, 30L, 36L, 48L, 40L, 28L, 36L, 19L,
			34L, 23L, 17L, 17L, 23L, 14L, 20L, 13L, 23L, 20L, 16L, 16L, 23L,
			14L, 15L, 4L, 5L, 5L, 11L, 11L, 7L, 4L, 6L, 5L, 2L, 4L, 2L, 4L,
			6L, 6L, 4L, 6L, 11L, 16L, 9L, 12L, 13L, 27L, 21L, 19L, 17L, 24L,
			27L, 30L, 29L, 25L, 35L, 33L, 30L, 29L, 31L, 29L, 22L, 27L, 24L,
			26L, 29L, 22L, 33L, 24L, 30L, 20L, 17L, 24L, 28L, 18L, 13L, 9L,
			14L, 11L, 11L, 19L, 10L, 8L, 8L, 9L, 3L, 7L, 14L, 4L, 9L, 14L,
			7L, 9L, 3L, 3L, 14L, 12L, 10L, 21L, 26L, 47L, 42L, 31L, 34L,
			33L, 52L, 56L, 70L, 112L, 70L, 47L, 48L, 49L, 66L, 56L, 61L,
			67L, 64L, 68L, 49L, 50L, 56L, 75L, 63L, 62L, 41L, 50L, 34L, 31L,
			38L, 30L, 32L, 26L, 30L, 36L, 35L, 46L, 48L, 44L, 51L, 59L, 71L,
			102L, 128L, 127L, 150L, 191L, 256L, 329L, 263L, 220L, 204L, 181L,
			99L, 54L, 80L, 102L, 127L, 73L, 68L, 64L, 55L, 67L, 84L, 85L,
			67L, 73L, 89L, 68L, 59L, 56L, 77L, 75L, 47L, 50L, 42L, 28L, 37L,
			37L, 27L, 12L, 15L, 22L, 8L, 15L, 17L, 10L, 9L, 11L, 20L, 13L,
			11L, 16L, 11L, 7L, 17L, 14L, 13L, 15L, 30L, 25L, 40L, 44L, 25L,
			21L, 48L, 56L, 60L, 45L, 55L, 32L, 46L, 61L, 42L, 37L, 43L, 34L,
			40L, 25L, 16L, 17L, 17L, 16L, 23L, 18L, 18L, 9L, 7L, 7L, 4L,
			3L, 2L, 8L, 3L, 1L, 1L, 2L, 3L, 3L, 2L, 0L, 0L, 2L, 2L, 0L, 6L,
			3L, 6L, 2L, 3L, 2L, 4L, 5L, 2L, 9L, 2L, 4L, 8L, 6L, 3L, 11L,
			14L, 15L, 20L, 9L, 20L, 28L, 38L, 30L, 30L, 23L, 16L, 22L, 28L,
			14L, 17L, 20L, 17L, 10L, 13L, 20L, 9L, 18L, 9L, 8L, 19L, 11L,
			4L, 6L, 6L, 8L, 13L, 8L, 8L, 5L, 16L, 12L, 11L, 18L, 10L, 22L,
			14L, 16L, 18L, 27L, 38L, 35L, 41L, 51L, 65L, 55L, 54L, 62L, 64L,
			56L, 65L, 71L, 75L, 71L, 72L, 47L, 27L, 35L, 25L, 19L, 37L, 38L,
			34L, 26L, 19L, 18L, 22L, 16L, 18L, 6L, 12L, 6L, 6L, 3L, 7L, 6L,
			1L, 3L, 2L, 2L, 1L, 10L, 3L, 3L, 1L, 1L, 2L, 6L, 3L, 3L, 5L,
			4L, 7L, 6L, 5L, 7L, 6L, 4L, 4L, 7L, 9L, 5L, 5L, 10L, 6L, 13L,
			6L, 5L, 5L, 9L, 3L, 6L, 11L, 7L, 7L, 15L, 9L, 6L, 6L, 6L, 7L,
			10L, 8L, 7L, 12L, 3L, 2L, 7L, 5L, 5L, 7L, 7L, 7L, 7L, 10L, 13L,
			10L, 14L, 11L, 20L, 25L, 17L, 18L, 25L, 21L, 31L, 32L, 26L, 35L,
			28L, 37L, 41L, 34L, 30L, 39L, 39L, 39L, 34L, 30L, 37L, 29L, 26L,
			15L, 22L, 15L, 20L, 14L, 10L, 21L, 14L, 14L, 9L, 11L, 5L, 6L,
			7L, 11L, 4L, 3L, 2L, 6L, 10L, 7L, 5L, 3L, 12L, 13L, 10L, 13L,
			13L, 8L, 21L, 18L, 8L, 7L, 20L, 14L, 14L, 7L, 14L, 10L, 13L,
			27L, 13L, 18L, 16L, 16L, 20L, 17L, 4L, 15L, 8L, 6L, 12L, 15L,
			11L, 10L, 15L, 17L, 7L, 7L, 8L, 9L, 12L, 12L, 5L, 4L, 11L, 4L,
			5L, 7L, 1L, 1L, 4L, 2L, 6L, 3L, 4L, 10L, 12L, 21L, 26L, 21L,
			30L, 45L, 56L, 75L, 83L, 82L, 126L, 119L, 137L, 131L, 112L, 82L,
			73L, 43L, 55L, 55L, 53L, 46L, 43L, 29L, 22L, 26L, 13L, 17L, 8L,
			13L, 10L, 17L, 19L, 9L, 9L, 9L, 3L, 7L, 7L, 0L, 2L, 3L, 3L, 1L,
			3L, 3L, 3L, 7L, 3L, 5L, 11L, 5L, 5L, 6L, 6L, 4L, 4L, 8L, 14L,
			12L, 16L, 10L, 16L, 18L, 15L, 23L, 17L, 33L, 15L, 13L, 11L, 14L,
			17L, 19L, 20L, 12L, 21L, 7L, 19L, 10L, 13L, 10L, 8L, 21L, 11L,
			9L, 14L, 14L, 15L, 18L, 16L, 12L, 20L, 8L, 3L, 13L, 4L, 1L, 10L,
			8L, 13L, 10L, 21L, 18L, 21L, 34L, 25L, 34L, 33L, 40L, 42L, 36L,
			72L, 75L, 76L, 92L, 71L, 112L, 106L, 101L, 170L, 135L, 106L,
			68L, 48L, 48L, 26L, 33L, 29L, 17L, 12L, 13L, 17L, 15L, 14L, 15L,
			10L, 9L, 2L, 6L, 8L, 5L, 1L, 2L, 3L, 4L, 3L, 1L, 3L, 5L, 2L,
			3L, 2L, 3L, 2L, 2L, 3L, 4L, 3L, 4L, 4L, 4L, 7L, 6L, 15L, 11L,
			9L, 9L, 12L, 13L, 13L, 13L, 20L, 28L, 45L, 28L, 34L, 41L, 36L,
			38L, 48L, 27L, 23L, 28L, 42L, 30L, 18L, 38L, 28L, 36L, 44L, 41L,
			35L, 28L, 28L, 22L, 26L, 24L, 9L, 21L, 10L, 15L)), .Names = c("season",
			"total_cases"), row.names = c(NA, -988L), class = c("tbl_df",
			"tbl", "data.frame"))
		)
}
